<Page x:Class="ClinicManagementSystem.Pages.ReportsPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      FlowDirection="RightToLeft"
      Title="Reports">

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Border Grid.Row="0" Background="White" CornerRadius="10" Padding="20" Margin="0,0,0,15">
            <StackPanel>
                <TextBlock Text="📈 التقارير" FontSize="24" FontWeight="Bold" Foreground="#333"/>
                <TextBlock Text="إنشاء وتصدير التقارير المختلفة" FontSize="14" Foreground="#666" Margin="0,5,0,0"/>
            </StackPanel>
        </Border>

        <!-- Reports Grid -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
            <UniformGrid Columns="2">
                <!-- Daily Report -->
                <Border Background="White" CornerRadius="15" Padding="25" Margin="10">
                    <Border.Effect>
                        <DropShadowEffect Color="#CCCCCC" BlurRadius="10" ShadowDepth="2" Opacity="0.3"/>
                    </Border.Effect>
                    <StackPanel>
                        <TextBlock Text="📅" FontSize="48" HorizontalAlignment="Center" Margin="0,0,0,10"/>
                        <TextBlock Text="التقرير اليومي" FontSize="18" FontWeight="Bold" 
                                   Foreground="#333" HorizontalAlignment="Center" Margin="0,0,0,10"/>
                        <TextBlock Text="تقرير شامل عن زيارات وإيرادات اليوم" FontSize="13" 
                                   Foreground="#666" TextWrapping="Wrap" HorizontalAlignment="Center" Margin="0,0,0,20"/>

                        <DatePicker x:Name="dpDailyDate" SelectedDate="" 
                                    Margin="0,0,0,15" HorizontalAlignment="Stretch"/>

                        <Button Content="📄 إنشاء PDF" Background="#2196F3" Foreground="White" 
                                BorderThickness="0" Padding="15,10" FontSize="14" Cursor="Hand" 
                                Click="DailyReportPDF_Click" Margin="0,5"/>
                        <Button Content="📊 تصدير Excel" Background="#4CAF50" Foreground="White" 
                                BorderThickness="0" Padding="15,10" FontSize="14" Cursor="Hand" 
                                Click="DailyReportExcel_Click" Margin="0,5"/>
                    </StackPanel>
                </Border>

                <!-- Monthly Report -->
                <Border Background="White" CornerRadius="15" Padding="25" Margin="10">
                    <Border.Effect>
                        <DropShadowEffect Color="#CCCCCC" BlurRadius="10" ShadowDepth="2" Opacity="0.3"/>
                    </Border.Effect>
                    <StackPanel>
                        <TextBlock Text="📊" FontSize="48" HorizontalAlignment="Center" Margin="0,0,0,10"/>
                        <TextBlock Text="التقرير الشهري" FontSize="18" FontWeight="Bold" 
                                   Foreground="#333" HorizontalAlignment="Center" Margin="0,0,0,10"/>
                        <TextBlock Text="إحصائيات شاملة للشهر المحدد" FontSize="13" 
                                   Foreground="#666" TextWrapping="Wrap" HorizontalAlignment="Center" Margin="0,0,0,20"/>

                        <ComboBox x:Name="cmbMonth" Margin="0,0,0,10">
                            <ComboBoxItem Content="يناير" Tag="1"/>
                            <ComboBoxItem Content="فبراير" Tag="2"/>
                            <ComboBoxItem Content="مارس" Tag="3"/>
                            <ComboBoxItem Content="أبريل" Tag="4"/>
                            <ComboBoxItem Content="مايو" Tag="5"/>
                            <ComboBoxItem Content="يونيو" Tag="6"/>
                            <ComboBoxItem Content="يوليو" Tag="7"/>
                            <ComboBoxItem Content="أغسطس" Tag="8"/>
                            <ComboBoxItem Content="سبتمبر" Tag="9"/>
                            <ComboBoxItem Content="أكتوبر" Tag="10"/>
                            <ComboBoxItem Content="نوفمبر" Tag="11"/>
                            <ComboBoxItem Content="ديسمبر" Tag="12" IsSelected="True"/>
                        </ComboBox>

                        <ComboBox x:Name="cmbYear" Margin="0,0,0,15">
                            <ComboBoxItem Content="2025" IsSelected="True"/>
                            <ComboBoxItem Content="2024"/>
                            <ComboBoxItem Content="2023"/>
                        </ComboBox>

                        <Button Content="📄 إنشاء التقرير" Background="#FF9800" Foreground="White" 
                                BorderThickness="0" Padding="15,10" FontSize="14" Cursor="Hand" 
                                Click="MonthlyReport_Click"/>
                    </StackPanel>
                </Border>

                <!-- Debts Report -->
                <Border Background="White" CornerRadius="15" Padding="25" Margin="10">
                    <Border.Effect>
                        <DropShadowEffect Color="#CCCCCC" BlurRadius="10" ShadowDepth="2" Opacity="0.3"/>
                    </Border.Effect>
                    <StackPanel>
                        <TextBlock Text="💰" FontSize="48" HorizontalAlignment="Center" Margin="0,0,0,10"/>
                        <TextBlock Text="تقرير الديون" FontSize="18" FontWeight="Bold" 
                                   Foreground="#333" HorizontalAlignment="Center" Margin="0,0,0,10"/>
                        <TextBlock Text="قائمة المرضى الذين عليهم مستحقات" FontSize="13" 
                                   Foreground="#666" TextWrapping="Wrap" HorizontalAlignment="Center" Margin="0,0,0,35"/>

                        <Button Content="📄 تقرير PDF" Background="#F44336" Foreground="White" 
                                BorderThickness="0" Padding="15,10" FontSize="14" Cursor="Hand" 
                                Click="DebtsReportPDF_Click" Margin="0,5"/>
                        <Button Content="📊 تصدير Excel" Background="#E91E63" Foreground="White" 
                                BorderThickness="0" Padding="15,10" FontSize="14" Cursor="Hand" 
                                Click="DebtsReportExcel_Click" Margin="0,5"/>
                    </StackPanel>
                </Border>

                <!-- Inventory Report -->
                <Border Background="White" CornerRadius="15" Padding="25" Margin="10">
                    <Border.Effect>
                        <DropShadowEffect Color="#CCCCCC" BlurRadius="10" ShadowDepth="2" Opacity="0.3"/>
                    </Border.Effect>
                    <StackPanel>
                        <TextBlock Text="📦" FontSize="48" HorizontalAlignment="Center" Margin="0,0,0,10"/>
                        <TextBlock Text="تقرير المخزون" FontSize="18" FontWeight="Bold" 
                                   Foreground="#333" HorizontalAlignment="Center" Margin="0,0,0,10"/>
                        <TextBlock Text="حالة المخزون والأصناف المنخفضة" FontSize="13" 
                                   Foreground="#666" TextWrapping="Wrap" HorizontalAlignment="Center" Margin="0,0,0,20"/>

                        <CheckBox x:Name="chkLowStockOnly" Content="المخزون المنخفض فقط" 
                                  Margin="0,10" HorizontalAlignment="Center"/>
                        <CheckBox x:Name="chkExpiringSoon" Content="قارب على الانتهاء فقط" 
                                  Margin="0,10" HorizontalAlignment="Center"/>

                        <Button Content="📊 تصدير Excel" Background="#9C27B0" Foreground="White" 
                                BorderThickness="0" Padding="15,10" FontSize="14" Cursor="Hand" 
                                Click="InventoryReport_Click" Margin="0,15,0,0"/>
                    </StackPanel>
                </Border>

                <!-- Custom Report -->
                <Border Background="White" CornerRadius="15" Padding="25" Margin="10">
                    <Border.Effect>
                        <DropShadowEffect Color="#CCCCCC" BlurRadius="10" ShadowDepth="2" Opacity="0.3"/>
                    </Border.Effect>
                    <StackPanel>
                        <TextBlock Text="🔍" FontSize="48" HorizontalAlignment="Center" Margin="0,0,0,10"/>
                        <TextBlock Text="تقرير مخصص" FontSize="18" FontWeight="Bold" 
                                   Foreground="#333" HorizontalAlignment="Center" Margin="0,0,0,10"/>
                        <TextBlock Text="اختر الفترة الزمنية المطلوبة" FontSize="13" 
                                   Foreground="#666" TextWrapping="Wrap" HorizontalAlignment="Center" Margin="0,0,0,15"/>

                        <TextBlock Text="من تاريخ:" FontSize="12" Margin="0,5"/>
                        <DatePicker x:Name="dpCustomFrom" Margin="0,5"/>

                        <TextBlock Text="إلى تاريخ:" FontSize="12" Margin="0,10,0,5"/>
                        <DatePicker x:Name="dpCustomTo" SelectedDate="" Margin="0,5"/>

                        <Button Content="📄 إنشاء التقرير" Background="#00BCD4" Foreground="White" 
                                BorderThickness="0" Padding="15,10" FontSize="14" Cursor="Hand" 
                                Click="CustomReport_Click" Margin="0,15,0,0"/>
                    </StackPanel>
                </Border>

                <!-- Patient Report -->
                <Border Background="White" CornerRadius="15" Padding="25" Margin="10">
                    <Border.Effect>
                        <DropShadowEffect Color="#CCCCCC" BlurRadius="10" ShadowDepth="2" Opacity="0.3"/>
                    </Border.Effect>
                    <StackPanel>
                        <TextBlock Text="👥" FontSize="48" HorizontalAlignment="Center" Margin="0,0,0,10"/>
                        <TextBlock Text="تقرير مريض" FontSize="18" FontWeight="Bold" 
                                   Foreground="#333" HorizontalAlignment="Center" Margin="0,0,0,10"/>
                        <TextBlock Text="تقرير شامل عن مريض محدد" FontSize="13" 
                                   Foreground="#666" TextWrapping="Wrap" HorizontalAlignment="Center" Margin="0,0,0,20"/>

                        <ComboBox x:Name="cmbPatient" DisplayMemberPath="FullName" 
                                  SelectedValuePath="PatientID" Margin="0,10"/>

                        <Button Content="🔍 بحث عن مريض" Background="#607D8B" Foreground="White" 
                                BorderThickness="0" Padding="15,10" FontSize="14" Cursor="Hand" 
                                Click="SearchPatient_Click" Margin="0,10"/>

                        <Button Content="📄 طباعة PDF" Background="#3F51B5" Foreground="White" 
                                BorderThickness="0" Padding="15,10" FontSize="14" Cursor="Hand" 
                                Click="PatientReport_Click" Margin="0,5"/>
                    </StackPanel>
                </Border>
            </UniformGrid>
        </ScrollViewer>
    </Grid>
</Page>